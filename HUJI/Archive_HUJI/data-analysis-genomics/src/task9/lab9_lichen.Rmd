

### Libraries used

Please load all libraries that you will use throughout the code in this block.

TODO:
```{r libraries}

library(ggplot2)
library(reshape2)

if (!require('data.table')){
  install.packages('data.table')
  library('data.table')
}
# library('tictoc')

if (!require('manipulate')){
  install.packages('manipulate')
  library('manipulate')
}
library(splines)
# install.packages("dplyr", repos = "https://cran.rstudio.com/")
library(dplyr)
library(segmented)

library('splines')

```


### Paths and Data

Please use this block to write the paths for all the files you are loading. 
If you have a function file, please add it to the submission and call it using a relative path. 

```{r paths}
######## CHANGE THESE FILENAMES


load("C:/Users/User/Documents/stat/lab/week7/GC_100.rda")
load("C:/Users/User/Documents/stat/lab/week7/reads_100_A2.rda")
load("C:/Users/User/Documents/stat/lab/week7/reads_100_B2.rda")
```

## Introduction 

Short intro discussing the goal of this week.

## Part 1

Short explanation on method or idea. 


```{r}

short_GC_100 <- GC_100[0:2471993]
# length(short_GC_100)
# length(reads_100_A2)
# length(reads_100_B2)

# Function to merge every 25 cells
merge_25_cells <- function(x) {
  merged <- sapply(seq(1, length(x), by=25), function(i) sum(x[i:min(i+24, length(x))]))
  return(merged)
}

# Apply the function to the datasets (merge every 25 cells)
# Cell of 2500 bases
merged_GC_100 <- merge_25_cells(short_GC_100)
merged_reads_100_A2 <- merge_25_cells(reads_100_A2)
merged_reads_100_B2 <- merge_25_cells(reads_100_B2)

# Set the scientific notation option to FALSE
options(scipen = 999)

# Plot the data with additional formatting
plot(merged_reads_100_A2 , ylim = c(0,500), xlim = c(10000,12000),
     main = "Reads in Cancer Sample 25M:30M",      # Title of the plot
     xlab = "Index",                    # Label for the x-axis
     ylab = "Read Count",               # Label for the y-axis
     col = "blue",                      # Color of the points
     pch = 19,                          # Shape of the points
     cex = 0.5)                         # Size of the points

# Add a grid for better readability
grid()

# Add vertical lines parallel to the y-axis
abline(v = 11420, col = "red")
abline(v = 11470, col = "red")




```

```{r}
# Set the scientific notation option to FALSE
options(scipen = 999)

# Plot the data with additional formatting
plot(merged_GC_100 , xlim = c(10000,12000),
     main = "Reads in Cancer Sample 25M:30M",      # Title of the plot
     xlab = "Index",                    # Label for the x-axis
     ylab = "Read Count",               # Label for the y-axis
     col = "blue",                      # Color of the points
     pch = 19,                          # Shape of the points
     cex = 0.5)                         # Size of the points

# Add a grid for better readability
grid()


```

Short explanation on what we learn from the graph. 


## Part 2


## Part 3

## Part 4

## Short summary

Something you've learned. 

