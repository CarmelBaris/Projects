---
title: "Lab Task 8"
author: "Group 6"
date: "`r format(Sys.time(), '%d/%m/%y')`"
output:
  html_document:
    code_folding: show
editor_options: 
  markdown: 
    wrap: sentence
---

Group members:

- Shawn Yakir , 315714980,  shawn.yakir@mail.huji.ac.il
- Sarah Levitz, 324673623, sarah.levitz@mail.huji.ac.il
- Carmel Baris, 318455276, carmel.baris@mail.huji.ac.il 

### Clean the environment
```{r clean}
rm(list = ls())
```

### Libraries used

```{r libraries}
library('splines')
library('scales')
```


### Paths
```{r paths}
path = "~/Carmel/RProjects/Lab_Benjamini/data"
# path = "/Users/alevi/Downloads/"
 # path = "\\Users\\shawn\\Desktop\\"
```


### Functions

Detect boxplot outliers: 
```{r out_func}
detect_outliers_boxplot = function(dat) {
  out = boxplot.stats(dat)$out
  out_ind = dat %in% out
  return(as.integer(out_ind))
}
```


Fitting bspline regression:

```{r fit_func}
f = function(X, Y, deg=3, knots=c(0.415, 0.45, 0.54), subs) {
  lm(Y ~ bs(X, degree = deg, knots = knots, Boundary.knots = c(min(X), max(X))),
     subset = subs)
}

```

Correcting functions:

```{r fix_funcs}

### My one sample corrections ...

### Median correction
fix_med = function(samp) {
  return(samp/median(samp,na.rm=TRUE))
}

### One sample correction
fix_gc_e = function(samp, preds, eps=0) {
  return((samp+eps)/(preds+eps))
}

### My two sample correction ...
fix_2samp_e = function(tumor, healthy, eps=0) {
  return((tumor+eps)/(healthy+eps))
}

```


### Load data

```{r dat}
load(sprintf("%s/reads_100_A2.rda",path))
load(sprintf("%s/reads_100_B2.rda",path))
load(sprintf("%s/GC_100.rda",path))
```


### Binning
```{r binning}
binsize = 25

chr2t_mat = matrix(reads_100_A2, nr = binsize)
chr2n_mat = matrix(reads_100_B2, nr = binsize)
GC_100=GC_100[1: (length(reads_100_A2)) ]
gc_mat = matrix(GC_100,nr=binsize)

reads2.5K_t2 = colSums(chr2t_mat)
reads2.5K_n2 = colSums(chr2n_mat)
GC2.5K = colMeans(gc_mat)

l_out = length(reads2.5K_n2)

## ------------------------------------------------
rm("chr2n_mat","chr2t_mat","gc_mat","reads_100_A2","reads_100_B2","GC_100") # remove from memory
```



### Outliers

```{r outliers0}
outliers0 = GC2.5K==0
s0 = sum(outliers0)
cat("(GC=0,reads=0) outliers\n")
cat("removed", s0, "datapoints, which are", round(s0/l_out*100,2),"% of all outliers")
```


```{r rmv_outliers0}
r_health_cln = reads2.5K_n2[!outliers0]
r_tumor_cln = reads2.5K_t2[!outliers0]
GC_cln = GC2.5K[!outliers0]
```


```{r outliers1}
print(0)
```


```{r outliers2}
outliers2 = 0<GC2.5K & GC2.5K<=0.2
s2 = sum(outliers2)
cat("GC outliers\n")
cat("include", s2, "datapoints, which are", round(s2/l_out*100,2),"% of all outliers")
```


```{r outliers3}
outliers3 = 0.2<GC2.5K & GC2.5K<0.28
s3 = sum(outliers3)
cat("GC outliers\n")
cat("include", s3, "datapoints, which are", round(s3/l_out*100,2),"% of all outliers")
```

```{r plot_outliers2_outliers3}
par(mfcol = c(1,2))

plot(GC2.5K, reads2.5K_n2, pch = 20, cex = 0.7, col = rgb(0, 0, 0, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(0,400),
     main = "Healthy Sample")

# Mark outliers
points(GC2.5K[outliers2], reads2.5K_n2[outliers2], col = "cyan3", pch = 20)
points(GC2.5K[outliers3], reads2.5K_n2[outliers3], col = "purple", pch = 20)

plot(GC2.5K, reads2.5K_t2, pch = 20, cex = 0.7, col = rgb(0, 0, 0, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(0,400),
     main = "Tumor Sample")

# Mark outliers
points(GC2.5K[outliers2], reads2.5K_n2[outliers2], col = "cyan3", pch = 20)
points(GC2.5K[outliers3], reads2.5K_n2[outliers3], col = "purple", pch = 20)
```

```{r find_boxplot_out}
find_out_boxplot = function(dat) {
  out = boxplot.stats(dat)$out
  out_ind = dat %in% out
  return(as.integer(out_ind))
}

```


```{r outliers4}

quantiles <- quantile(reads2.5K_n2, c(0.25, 0.75))
whiskers <- boxplot.stats(reads2.5K_n2)$stats[c(1, 5)]


out_t2 = find_out_boxplot(reads2.5K_t2)
out_n2 = find_out_boxplot(reads2.5K_n2)
s4 = sum(out_t2 | out_n2)
cat("include", s4, "datapoints, which are", round(s4/l_out*100,2),"% of all outliers")

```


```{r outliers5}
outliers5 = !GC2.5K==0 & reads2.5K_t2==0
s5 = sum(outliers5)
cat("(GC>0,r_tumor=0) outliers\n")
cat("include", s5, "datapoints, which are", round(s5/l_out*100,2),"% of all outliers")
```


```{r outliers6}
outliers6 = !GC2.5K==0 & reads2.5K_n2==0
s6 = sum(outliers6)
cat("(GC>0,r_healthy=0) outliers\n")
cat("include", s6, "datapoints, which are", round(s6/l_out*100,2),"% of all outliers")
```


```{r outliers7}
outliers7 = reads2.5K_t2<5 | reads2.5K_n2<5
sum7 = sum(outliers7)
cat("Extra Read outliers\n")
cat("include", sum7, "datapoints, which are", round(sum7/l_out*100,2),"% of all outliers")
```

```{r plot_outliers5}
par(mfcol = c(2,2))

plot(GC2.5K, reads2.5K_t2, pch = 20, cex = 0.7, col = rgb(0.5, 0.5, 0.5, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(0,400),
     main = "Tumor Sample")

points(GC2.5K[outliers5], reads2.5K_t2[outliers5], col = "cyan4", pch = 20)

plot(GC2.5K, reads2.5K_t2, pch = 20, cex = 0.7, col = rgb(0.5, 0.5, 0.5, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(0,10),
     main = "Tumor Sample")

# Mark outliers
out6not5 = outliers6!=outliers5
points(GC2.5K[out6not5], reads2.5K_t2[out6not5], col = "cyan4", pch = 20)
points(GC2.5K[out6not5], reads2.5K_n2[out6not5], col = "purple4", pch = 20)

plot(GC2.5K, reads2.5K_n2, pch = 20, cex = 0.7, col = rgb(0.5, 0.5, 0.5, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(0,400),
     main = "Healthy Sample")
points(GC2.5K[outliers6], reads2.5K_n2[outliers6], col = "purple4", pch = 20)

plot(GC2.5K, reads2.5K_n2, pch = 20, cex = 0.7, col = rgb(0.5, 0.5, 0.5, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(0,10),
     main = "Healthy Sample")

out5not6 = outliers5!=outliers6
points(GC2.5K[out5not6], reads2.5K_t2[out5not6], col = "cyan4", pch = 20)
points(GC2.5K[out5not6], reads2.5K_n2[out5not6], col = "purple4", pch = 20)
```


```{r plot_outliers3}
par(mfcol = c(1,2))

plot(GC2.5K, reads2.5K_t2, pch = 20, cex = 0.7, col = rgb(0, 0, 0, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(0,100),
     main = "Healthy Sample")

# Mark outliers
points(GC2.5K[outliers5], reads2.5K_n2[outliers5], col = "cyan3", pch = 20)
points(GC2.5K[outliers6], reads2.5K_n2[outliers6], col = "purple3", pch = 20)
# Add legend
legend("topleft", legend = c("Tumor Outliers", "Healthy Outliers"), col = c("purple", "cyan3"), pch = 20, bty = "n", cex = 0.7)
```


```{r plot_outliers}
quantiles <- quantile(reads2.5K_t2, c(0.25, 0.75))
whiskers <- boxplot.stats(reads2.5K_t2)$stats[c(1, 5)]

lim = 2000

# Create the scatter plot
plot(GC2.5K, reads2.5K_t2, pch = 20, cex = 0.7, col = rgb(0, 0, 0, 0.3),
     xlab = "GC Content (cleaned)", ylab = "Read Counts (cleaned)",
     ylim = c(100,lim),
     main = "Tumor Sample")

# Mark outliers
points(GC2.5K[out_t2], reads2.5K_t2[out_t2], col = "purple", pch = 20)
points(GC2.5K[out_n2], reads2.5K_t2[out_n2], col = "cyan3", pch = 20)

# Add legend
legend("topleft", legend = c("Tumor Outliers", "Healthy Outliers"), col = c("purple", "cyan3"), pch = 20, bty = "n", cex = 0.7)

par(mfrow = c(1,1))

plot(1)

```


```{r rm_env}
## ------------------------------------------------
rm("path","detect_outliers_boxplot", "find_out_boxplot","out_n2","out_reads_xtra","out_t2") # remove from memory
# rm("GC2.5K", "reads2.5K_n2", "reads2.5K_t2")
```


### Plot Setup
```{r samp1}
set.seed(50)
samp1 = sample(length(r_health_cln), 10000)
```

```{r colors}
color_tumor = rgb(0.8, 0.8, 0.8, 0.6)
col_healthy = rgb(0.3, 0.3, 0.3, 0.4)
```

```{r stiched_range}
loc2bin = function(v, bin_size){
  return((v*1000000)/bin_size)}

bins = loc2bin(c(25,35,75,80),2500)
stiched_range = c(bins[1]:bins[2], bins[3]:bins[4])

```


### Non-Parametric Regression


```{r fit_models}
l_2n = length(r_health_cln)
l_2t = length(r_tumor_cln)

myknots = c(0.415, 0.45, 0.54)
pred_range = seq(0.2,0.75,0.01)

GC=GC_cln[1:l_2n]
r_health_cln = r_health_cln
r_tumor_cln = r_tumor_cln

subs_n = (r_health_cln>50)&(r_health_cln<350)
subs_t = (r_tumor_cln>50)&(r_tumor_cln<350)

# mod_2n = f(GC, r_health_cln, subs = subs_n)
# mod_2t = f(GC, r_tumor_cln, subs = subs_n)
mod_2n = lm(r_health_cln~bs(GC, degree = 3),subset = subs_n)
mod_2t = lm(r_tumor_cln~bs(GC, degree = 3),subset = subs_t)

resp2n = predict(mod_2n,list(GC=pred_range))
preds_2n = predict(mod_2n,list(GC=GC_cln))

resp2t = predict(mod_2t,list(GC=pred_range))
preds_2t = predict(mod_2t,list(GC=GC_cln))

```


```{r fit_bs}
# Fit B-spline Regression Models
GC_healthy = GC2.5K
mod_healthy = lm(reads2.5K_n2 ~ bs(GC_healthy, degree = 3))

pred_healthy = predict(mod_healthy, list(GC_healthy = GC_healthy))
# Tumor Sample
reads2.5K_t2_cl = reads2.5K_t2[1:l_2n]  # Ensure tumor data matches in length
mod_tumor = lm(reads2.5K_t2 ~ bs(GC_healthy, degree = 3))
pred_tumor = predict(mod_tumor, list(GC_healthy = GC_healthy))

```


```{r pred_range}
# Define the range for predictions
pred_range = seq(0.2, 0.75, 0.01)

# Predict values over the range for both models
preds_healthy = predict(mod_healthy, newdata = data.frame(GC_healthy = pred_range))
preds_tumor = predict(mod_tumor, newdata = data.frame(GC_healthy = pred_range))

```



### Healthy Fit vs. Tumor Fit

```{r plot_Ys_GC}
# Combined Plot
par(mfcol = c(1, 1), mar = c(5, 5, 4, 2))

# Plot the data points first
plot(GC_healthy, reads2.5K_t2, col = col_healthy, pch = 20, cex = 0.5, ylab = "Binned Reads (2,500 per bin)", xlab = "GC Content", main = "Healthy vs Tumor Sample", ylim = c(0,400))
points(GC_healthy, reads2.5K_n2, col = color_tumor, pch = 20, cex = 0.5)

# Add the regression lines on top
lines(pred_range, preds_healthy, col = 'darkblue', lwd = 2)
lines(pred_range, preds_tumor, col = 'darkred', lwd = 2)

# Add legend
legend("topleft", legend = c("Tumor Sample", "Healthy Sample"), col = c(col_healthy, color_tumor), pch = 20, bty = "n")

```


### One sample fixes

```{r fixing_1samp}
# take maximum with 0
preds1n = pmax(predict(mod_2n,list(GC=GC_cln)),0)
preds1t = pmax(predict(mod_2t,list(GC=GC_cln)),0)

eps = 0.3

# One Sample with espilon, Healthy
fixed_2n_gc_med_eps = fix_med(fix_gc_e(r_health_cln, preds1n[1:l_2n], eps))
unfixed_2n_gc_med_eps = fix_med(fix_gc_e(r_health_cln, rep(1,l_2n), eps))

# One Sample with espilon, Tumor
fixed_2t_gc_med_eps = fix_med(fix_gc_e(r_tumor_cln, preds1t[1:l_2t], eps))
unfixed_2t_gc_med_eps = fix_med(fix_gc_e(r_tumor_cln, rep(1,l_2t), eps))
```

### Two sample fixes

```{r fixing_2samp}
# after GC fix (no espilon)
gc_fixed_healthy = fix_med(fix_gc_e(r_health_cln, preds1n[1:l_2n]))
gc_fixed_tumor = fix_med(fix_gc_e(r_tumor_cln, preds1t[1:l_2t]))

# before GC fix (no espilon)
gc_unfixed_healthy = fix_med(fix_gc_e(r_health_cln, rep(1,l_2n)))
gc_unfixed_tumor = fix_med(fix_gc_e(r_tumor_cln, rep(1,l_2t)))

med_2samp = fix_med(fix_2samp_e(gc_unfixed_tumor,gc_unfixed_healthy))
med_2samp_eps0.3_gc = fix_med(fix_2samp_e(gc_fixed_tumor, gc_fixed_healthy, 0.3))
med_2samp_eps0.3 = fix_med(fix_2samp_e(gc_unfixed_tumor,gc_unfixed_healthy, 0.3))
med_2samp_epsone = fix_med(fix_2samp_e(gc_unfixed_tumor,gc_unfixed_healthy, 1.0))
med_2samp_epsten = fix_med(fix_2samp_e(gc_unfixed_tumor,gc_unfixed_healthy,10.0))


```


### Plotting fixes


```{r plot_fixes_1samp_h}
par(mfcol = c(3,1),mar = c(2,5,2,2))

# No fix for Healthy
plot(r_health_cln[stiched_range], 
     main = "Before Any Fix",
     ylab = "Reads Count",xaxt = "n",
     ylim = c(0,400), cex = 0.6, pch=20, col = col_healthy)
# abline(h=1, col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lwd = c(1.7, 1.7, 1.2))

# Med fix for Healthy
plot(unfixed_2n_gc_med_eps[stiched_range], 
     ylab = "Number of Copies",xaxt = "n",
     main = "After Median Fix (Full Width)",
     ylim = c(0,2), cex = 0.6, pch=20, col = col_healthy)
abline(h=1, col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lwd = c(1.7, 1.7, 1.2))

# GC fix for Healthy
plot(fixed_2n_gc_med_eps[stiched_range], 
     ylab = "Number of Copies",xaxt = "n",
     main = "After 'One Sample' GC Fix (Full Width)",
     ylim = c(0,2), cex = 0.6, pch=20, col = col_healthy)
abline(h=1, col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lwd = c(1.7, 1.7, 1.2))

# ----------------------------------
```


```{r plot_fixes_1samp_t}

par(mfcol = c(3,1),mar = c(2,5,2,2))

# No fix for Tumor
plot(r_tumor_cln[stiched_range], 
     ylab = "Count of Reads (Bins of 2.5K)", xaxt = "n",
     ylim = c(0,400), cex = 0.6, pch=20, col = color_tumor)
# abline(h=1, col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lwd = c(1.7, 1.7, 1.2))
mtext("Selected Locations in Chrom1 (25M-35M, 75M-80M)", side = 1, cex = 0.8)
# Med fix for Tumor
plot(unfixed_2t_gc_med_eps[stiched_range], 
     ylab = "Number of Copies", xaxt = "n",
     ylim = c(0,2), cex = 0.6, pch=20, col = color_tumor)
abline(h=1, col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lwd = c(1.7, 1.7, 1.2))
mtext("Selected Locations in Chrom1 (25M-35M, 75M-80M)", side = 1, cex = 0.8)
# GC fix for Tumor
plot(fixed_2t_gc_med_eps[stiched_range], 
     ylab = "Number of Copies", xaxt = "n",
     ylim = c(0,2), cex = 0.6, pch=20, col = color_tumor)
abline(h=1, col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lwd = c(1.7, 1.7, 1.2))
mtext("Selected Locations in Chrom1 (25M-35M, 75M-80M)", side = 1, cex = 0.8)

plot(1)

```



### Plotting Iteratively Applied Fixes

```{r plot_t_1samp2samp}
par(mfrow=c(1,1), mar = c(1.5,2.5,2.5,2.5), oma = c(3,4,3,4))

verticals = seq(from = 1500, to = 6000, by = 250)

plot(unfixed_2t_gc_med_eps[stiched_range], 
     ylab = "", xaxt = "n",
     ylim = c(0,2), xlim = c(0,6000),
     cex = 1, pch=20, col = col_healthy
     )
abline(h=c(0.5,1.5), v=verticals, col= "lightgray", lwd = 0.6)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
abline(h=1, col=4, lwd = 2)
mtext("Median", side = 3, cex = 1, col = rgb(0,0,0,0.8), line = 0.5)

## one sample (median + GC correction)
plot(fixed_2t_gc_med_eps[stiched_range], 
     main = "",
     ylab = "", xlab = "", xaxt = "n", ylim = c(0,2), xlim = c(0,6000),
     cex = 0.9, pch=20, col = col_healthy)
abline(h=c(0.5,1.5), v=verticals, col= "lightgray", lwd = 0.6)
abline(h=1, col=4, lwd = 2)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
mtext("Median & GC", side = 3, cex = 1, col = rgb(0,0,0,0.8), line = 0.5)

plot(med_2samp_eps0.3_gc[stiched_range], 
     main = "",
     ylab = "", xlab = "", xaxt = "n", ylim = c(0,2), xlim = c(0,6000),
     cex = 0.8, pch=20, col = col_healthy)
abline(h=c(0.5,1.5), v=verticals, col= "lightgray", lwd = 0.6)
abline(h=1, col=4, lwd = 2)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
mtext("Median & GC & Two-Samp", side = 3, cex = 1, col = rgb(0,0,0,0.8), line = 0.5)

plot(med_2samp_eps0.3[stiched_range], 
     main = "",
     ylab = "", xlab = "", xaxt = "n", ylim = c(0,2), xlim = c(0,6000),
     cex = 0.7, pch=20, col = col_healthy)
abline(h=c(0.5,1.5), v=verticals, col= "lightgray", lwd = 0.6)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
abline(h=1, col=4, lwd = 1.5)
mtext("Median & Two-Samp", side = 3, cex = 1, col = rgb(0,0,0,0.8), line = 0.5)

## write text on outer margins
mtext("Comparing Two-Sample Fixes (eps = 0.3)",outer = TRUE, side = 3, line = 1, font = 2)
mtext("Est. Number of Copies (a hat)", outer = TRUE, side = 2, line = 1, cex = 0.8)
mtext("Selected Locations in Chrom1 (25M-35M, 75M-80M)", outer = TRUE, side = 1, cex = 0.8, line = 1)


dots=c(1,2,3,4,5,6,7,8)
plot(dots, col=dots, pch=20, cex=4)
```


### Effects of the epsilon

```{r plot_epsilons}
par(mfrow=c(4,1), mar = c(1.5,2.5,2.5,2.5), oma = c(3,4,3,4))

plot(med_2samp[stiched_range],
     ylab = "", xaxt = "n",
     ylim = c(0,2), cex = 0.5, pch=20, col = col_healthy)
abline(h=1,col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
mtext("epsilon = 0", line = 1, side = 3, cex = 0.8)

plot(med_2samp_eps0.3[stiched_range],
     ylab = "", xaxt = "n",
     ylim = c(0,2), cex = 0.5, pch=20, col = col_healthy)
abline(h=1,col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
mtext("epsilon = 0.3", line = 1, side = 3, cex = 0.8)

plot(med_2samp_epsone[stiched_range],
     ylab = "", xaxt = "n",
     ylim = c(0,2), cex = 0.5, pch=20, col = col_healthy)
abline(h=1,col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
mtext("epsilon = 1", line = 1, side = 3, cex = 0.8)

plot(med_2samp_epsten[stiched_range],
     ylab = "", xaxt = "n",
     ylim = c(0,2), cex = 0.5, pch=20, col = col_healthy)
abline(h=1,col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c("orange","orange",6), lt = c(1, 1, 2), lwd = c(1.4, 1.4, 1.3))
mtext("epsilon = 10", line = 1, side = 3, cex = 0.8)

## write text on outer margins
mtext("Comparing Epsilons In Two-Sample Fix (w/o GC)",outer = TRUE, side = 3, line = 1, font = 2)
mtext("Est. Number of Copies (a hat)", outer = TRUE, side = 2, line = 1, cex = 0.8)
mtext("Selected Locations in Chrom1 (25M-35M, 75M-80M)", outer = TRUE, side = 1, cex = 0.8, line = 1)



plot(1)
```


### Effects of Two Sample Fixes
```{r plot_gc_2samp}
## ----------------------
par(mfcol = c(2,1), mar = c(2,5,1,1))

plot(med_2samp_eps0.3[stiched_range],
     main = "Combining GC & Two-Sample (Epsilon = 0.3)",
     ylab = "Before GC fix", xaxt = "n", xlab = "",
     ylim = c(0,2),cex = 0.5,pch=20, col = rgb(0.3,0.3,0.3,0.7))
abline(h=1,col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c(5,5,6), lt=c(1,1,2), lwd = 1.2)

plot(med_2samp_eps0.3_gc[stiched_range], 
     ylab = "After GC fix", xaxt = "n", xlab = "",
     ylim = c(0,2),cex = 0.5, pch=20, col = rgb(0.3,0.3,0.3,0.7))
abline(h=1,col=4, lwd = 1.5)
abline(v=c(750,900,4000),col=c(5,5,6), lt=c(1,1,2), lwd = 1.2)
mtext("Selected Locations in Chrom1 (25M-35M, 75M-80M)", side = 1, cex = 0.8)

plot(1)

```










