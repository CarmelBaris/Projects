---
title: "Quiz4"
output: html_document
date: "2022-11-24"
editor_options: 
  markdown: 
    wrap: 72
---

when we launch R, run this line to load the tinytex package

```{r warning=FALSE}
# tinytex::install_tinytex() #install required only once per user
library(tinytex)
```

Run to generate document including embedded R code and its outputs:

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Method Of Moments

MOM equations: 
$$ 
\begin{aligned}
\frac{\widehat{\alpha}}{\widehat{\alpha} + \widehat{\beta}} &= \overline{X}_n\\ \dfrac{\widehat{\alpha}\widehat{\beta}}{(\widehat{\alpha} + \widehat{\beta})^2(\widehat{\alpha} + \widehat{\beta} + 1)} &= \dfrac{1}{n} \sum_{i=1}^n (X_i - \overline{X}_n)^2 = \dfrac{n-1}{n}S^2_n = \widehat{\mu}\prime_2 
\end{aligned}
$$

We can re-express $ \widehat{\mu} \prime _2 $ as

$$
\widehat{\mu}\prime _2 = \dfrac{R \cdot \widehat{\alpha}}{ \left( \dfrac{\widehat{\alpha}}{\overline{X}_n} \right)^2 \left( \dfrac{\widehat{\alpha}}{\overline{X}_n} \right)}
$$

where $R = \dfrac{1}{\overline{X}_n} - 1 = \dfrac{\widehat{\beta}}{\overline{X}_n}$

# Question 1: extracting Exp() parameter using Max Likelihood Est.

$$
\begin{align*}

& X_{1}, X_{2}, X_{3}, ...., X_{n}\sim {\ Exp(\lambda)} \\
& L(\lambda) 
  = \prod_{i = 1}^{n} f_\lambda(X_i)
  = \lambda^n \ e^{-\lambda \ \sum_{i=1}^{n} (X_{i})} \\
& \hat{\lambda} 
  = \displaystyle \frac{1}{\overline{X}}
  =\displaystyle \frac{n}{\sum_{i=1}^{n} (X_{i})}

\end{align*}
$$


According to the given data: 

$$
X_{1}, X_{2}, X_{3}\sim {\ Exp(\lambda)}\\
\hat\lambda = 
\displaystyle \frac{1}{\overline{X}}=
\displaystyle \frac{1}{\frac{1}{n} \sum_{i=1}^{n} (X_{i})}=
\displaystyle \frac{n}{\sum_{i=1}^{n} (X_{i})}
\\ \Rightarrow
\frac{1}{\frac{1}{3} \sum_{i=1}^{3} (X_{i})}=
\displaystyle \frac{3}{\sum_{i=1}^{3} (X_{i})}=
\displaystyle \frac{3}{X_{1}+ X_{2}+ X_{3}}=
\frac{3}{6.4+6+1.4}=13.8
$$ \newpage

# Question 2: extracting continuous U() parameter using Method of Moments

$$Y_{cont.} \sim U(0, \theta)$$

# Question 3: extracting continuous U() parameter using Max Likelihood


\documentclass{article}
\usepackage{amsmath}

\begin{document}
    f(x)= 
\begin{cases}
    \frac{x^2-x}{x},& \text{if } x\geq 1\\
    0,              & \text{otherwise}
\end{cases}
\end{document}

Y is a continuous and Uniform variable.

$$
Y_{cont.} \sim U(0, \theta)
\begin{equation*}
\\I_{(0, \theta)}(X_i)= \left\{
\begin{array}{rl}
1 & \text{if } x < 0,\\
0 & \text{if } x > 0.
\end{array} \right.
\end{equation*}
$$

Function of maximum likelihood for cont. uniform distr. 
$$
\\L(\theta)=\prod_{i = 1}^{n} f_\theta(X_i) \ I_{(0, \theta)}(X_i)=
\prod_{i = 1}^{n}\displaystyle \frac{1}{\theta - 0}I_{(0, \theta)}(X_i)
= \displaystyle \frac{1}{\theta^n} \prod_{i = 1}^{n} I_{(0, \theta)}(X_i) 
$$

$$
f_\theta(X_i) = e^{-(X-\theta)}\dot \ I_{x \geq \theta}(X_i), \ \ \theta>0
$$
Because $L(\theta)$ is a fraction, when the estimator $\hat\theta$ is at
its lowest value, we get that $L(\theta)$ is at its maximal value.
Therefore, we'll select the minimal bound for $\theta$, which in
continuous uniform distribution we know it equals to $max[X_i] = 8.2$.

According to the given data & using the Max Likelihood for a continuous
Uniform distribution: 
$$
X_{1}, X_{2}, X_{3}\sim {\ U(0, \theta)}\\
\Rightarrow \hat\theta = max_{x_i}=8.2
$$

# Question 4: extracting cont. Normal distr. param using Max Likelihood

According to the given data & using the Max Likelihood for a continuous
Uniform distribution:
$$
X_{1}, X_{2}, X_{3}\sim {\ Norm(\mu , \sigma^2)}\\
\\ \Rightarrow \overline{X} = \frac{1}{X_{1}+ X_{2}+ X_{3}} = = 
\frac{1}{2+3+6} = \frac{1}{11}
\\ \Rightarrow \hat{\sigma^2} = 
\frac{1}{n} \sum_{i=1}^{n} (X_{i}-\overline{X})^2 =
\frac{1}{3}[(2-\frac{1}{11})^2 + (3-\frac{1}{11})^2 + (6-\frac{1}{11})^2]=
\frac{5690}{363} \approx 15.67
$$

# Quesion 5

$$ 
f(x;\theta)={e^{-(x-\theta)}}\dot \ I_{x \geq 0}
$$
Seeing as we are
given that $\theta>0$, and according to the condition of the indicator
$x\geq\theta$ we understand that the above function will produce a
result only if $x\geq\theta>0$. In other words, $X_i$ is the upper-bound
of $\theta$. Looking at our given density function, we realize that it
is a **negative** exponential, which grows as $(x-\theta)$ decreases.
The smaller the value of x, the bigger the function's value will be.
Therefore

# Question 6

$$
f(x;\theta >0)=\frac {3x^2}{2\theta ^3}\cdot I_{\{-\theta \leq x\leq \theta \}}
\\L(\theta)= \prod_{i = 1}^{n}\frac {3x^2}{2\theta ^3}\cdot I \ ,\ where \ I_{\{-\theta \leq x\leq \theta \}}
\\l_e(\theta)=
log[{\prod_{i = 1}^{n}\frac {3x_{i}^2}{2\theta ^3}\cdot I}]=
\sum_{i=1}^{n} ({log{\frac {3x_{i}^2}{2\theta ^3}\cdot  I}})=
\\\text{if }  \ \hat\theta=max(X_i) 
\\\text{if }  \ \hat\theta=min(X_i) 
\\\text{if }  \ \hat\theta=max(|X_i|) 
\\\text{if }  \ \hat\theta=|max(X_i) |
$$


#Question 7
$$
f(x;\theta)=\frac {3}{4\theta ^3}(\theta +x)(\theta -x)\cdot I_{\{-\theta \leq x\leq \theta \} }
\\I_x=1, \ -\theta \leq x\leq \theta \Leftrightarrow x\leq |\theta|
\\f(x)=\frac {3}{4\theta ^3}(\theta^2 -x^2)\cdot I
=(\frac {3}{4\theta}-\frac {3x^2}{4\theta^3})\cdot I
$$

We'll calculate the first moment $E(X)$ for the given range of $x$: 
$$
\\I_x=1, \ -\theta \leq x\leq \theta
\\ \Rightarrow E(X)= \int_{x} x \cdot f(x)= 
\int_{{-\theta}}^{\theta} [(\frac {3}{4\theta}-\frac{3x^2}{4\theta^3}) \cdot I] \,dx=
\int_{{-\theta}}^{\theta} [(\frac {3}{4\theta}-\frac{3x^2}{4\theta^3}) \cdot 1] \,dx
\\ = \frac {3}{4\theta}\biggl[x\biggr]_{-\theta}^{\theta} -
\frac{3}{8\theta}\biggl[x^3\biggr]_{-\theta}^{\theta}
\ = \frac {3}{4\theta}\biggl[2\theta\biggr] -
\frac{3}{8\theta}\biggl[2\theta^3\biggr]
\ = 1.5 - 0.75\theta^2
$$

#Question 8

```{r}
 x <- c(1.18,1.29,0.49,0.19,1.57,3.13,1.61,0.92,0.42,4.48,0.91,0.05,0.11, 0.68,0.76,1.89,3.09,4.83,1.53,1.94,1.32,0.08,1.29,0.06,0.63,0.25, 1.93,1.01,0.01,0.78)
```

$$
X_{1}, X_{2}, \dots, X_{30}\sim {\ Exp(\lambda)}\\
F_x(X)= 1-e^{-\lambda x}\\
\hat\lambda = 
\displaystyle \frac{1}{\overline{X}}
$$ 

Let's calculate using R:

```{r, echo=FALSE}
lambda <- 1/mean(x)
```

$$
F_x(X)= 1-e^{-0.78 x}
\\ \Rightarrow P(X \geq 2)=1-F_x(2)=1-e^{-0.78 \cdot2}
$$ 

We'll calculate using R:

```{r, echo=FALSE}
pexp(q=2, rate=lambda, lower.tail = FALSE)
```

#Question 9

```{r}
y <- c(1,1,4,3,2,3,0,4,6,7)
```

$$
X_{1}, X_{2}, \dots, X_{30}\sim {\ Pois(\alpha)}\\
\hat\alpha = {\overline{X}}=\sum_{i=1}^{10}X_i
$$ 

Let's calculate using R:

```{r}
lambda <- 1/mean(y)
```

$$
F_x(X)= 1-e^{-0.78 x}
\\ \Rightarrow P(X \geq 2)=1-F_x(2)=1-e^{-0.78 \cdot2}
$$ 


We'll calculate using R:

```{r}
ppois(q=2, lambda=lambda, lower.tail = FALSE)
```

# Question 10

$$ 
f(x;\theta)={\theta^{\ 4} x^3 e^{-\theta x}}\dot \ I_{x>0}\dot \ C
$$


